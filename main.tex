\documentclass[10pt]{beamer}

\usetheme{metropolis}
\usepackage{appendixnumberbeamer}

\usepackage{booktabs}							% You should use \toprule, \midrule, and \bottomrule in tables
\usepackage{tabularx}								% Helps with scaling the table to content
\usepackage{natbib}

\usepackage{algorithm}      % `algorithm` environment
\usepackage{algorithmic}    % pseudocode

\usepackage{pgfplots}								% Because figures with DIKZ & pgfplots are superior 		
\usepackage{tikz}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Figures & graphics
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usetikzlibrary{calc}
\usetikzlibrary{positioning}
\usetikzlibrary{shapes.geometric}

\usepgfplotslibrary{colorbrewer}
\usepgfplotslibrary{external}
\usepgfplotslibrary{fillbetween}
\usepgfplotslibrary{groupplots}
\usepgfplotslibrary{dateplot}
\pgfplotsset{compat=1.14}

\usepackage{caption}								% In presentation we should keep the caption little smaller
\captionsetup[figure]{font=scriptsize}

\usepackage{comment}							% Just to show you the possible colors (see below)

\newcommand{\themename}{\textbf{\textsc{metropolis}}\xspace}
\newcommand{\rom}[1]
    {\MakeUppercase{\romannumeral #1}}

\newcommand{\shapelet}     {s}                               % one shapelet
\newcommand{\shapelets}    {\mathcal{S}}                     % set of shapelets
\newcommand{\oneseries}    {T}                               % one time series
\newcommand{\allseries}    {\mathcal{T}}                     % set of time series
\newcommand{\featurevector}{\phi}                            % feature vector
\newcommand{\landau}[1]    {\mathcal{O}\left(#1\right)}      % complexity symbol
\renewcommand{\natural}{\mathds{N}}                          % natural numbers
\newcommand{\longmethod}{Wasserstein Time Series Kernel}

\DeclareMathOperator{\kernel}     {k}                        % generic kernel
\DeclareMathOperator{\basekernel} {\kernel_{\text{base}}}    % base kernel
\DeclareMathOperator{\dist}       {dist}                     % distance function
\DeclareMathOperator{\metric}     {\dist}                    % synonym for  `\dist`
\DeclareMathOperator{\wasserstein}{W\!}                      % Wasserstein distance
\DeclareMathOperator{\Method}     {WTK}                      % use this as an operator and make it

\title{A Wasserstein Subsequence Kernel for Time Series}
\subtitle{}
\date{\today}
\author{\textbf{Christian Bock, Matteo Togninalli}, Elisabetta Ghisu, Thomas Gumbsch, \\ Bastian Rieck, Karsten Borgwardt}
\institute{Department of Biosystems Science and Engineering \\ Machine Learning and Computational Biology Group}
\titlegraphic{
	\hfill
	\includegraphics[width=1.4cm]{eth_logo_kurz_pos.pdf}
}

% An example to change citation style in presentation
% \setcitestyle{numbers}
% \setcitestyle{authoryear}

\begin{document}

\maketitle


\begin{frame}{ETH Colors}
	\begin{tikzpicture}
	\footnotesize
        \fill[ETHa] (0,0) rectangle (0.5,0.5);
        \node at (0,-0.2) {ETHa};
        \fill[ETHb] (1,0) rectangle (1.5,0.5);
        \node at (1,-0.2) {ETHb};
        \fill[ETHc] (2,0) rectangle (2.5,0.5);
        \node at (2,-0.2) {ETHc};
        \fill[ETHd] (3,0) rectangle (3.5,0.5);
        \node at (3,-0.2) {ETHd};
        \fill[ETHe] (4,0) rectangle (4.5,0.5);
        \node at (4,-0.2) {ETHe};
        \fill[ETHf] (5,0) rectangle (5.5,0.5);
        \node at (5,-0.2) {ETHf};
        \fill[ETHg] (6,0) rectangle (6.5,0.5);
        \node at (6,-0.2) {ETHg};
        \fill[ETHh] (7,0) rectangle (7.5,0.5);
        \node at (7,-0.2) {ETHh};
        \fill[ETHi] (8,0) rectangle (8.5,0.5);
        \node at (8,-0.2) {ETHi};
	\end{tikzpicture}
\end{frame}



\begin{frame}{Table of contents (internal)}
  \setbeamertemplate{section in toc}[sections numbered]
  \tableofcontents[hideallsubsections]
\end{frame}

\section{Motivation}

\begin{frame}{Time Series Classification in a Nutshell}
	\input{nutshell.tex}
\end{frame}

\section{Feature Space: Subsequences and Optimal Transport}
\begin{frame}{Subsequence Extraction}
	\input{subsequence_extraction.tex}	
\end{frame}

\begin{frame}{Subsequence Distance Matrix}
	\input{subsequences_distance.tex}
\end{frame}

\section{Optimal Transport and the Wasserstein Distance}

\begin{frame}{Optimal Transport}
	\input{OT_history.tex}
\end{frame}

\begin{frame}{The Swiss Kantorovich Problem}
	\input{kantorovich_0.tex}
\end{frame}

\begin{frame}{The Swiss Kantorovich Problem}
	\input{kantorovich_1.tex}
\end{frame}

\begin{frame}{Wasserstein Distance on Time Series}
  \centering
  \begin{columns}
  \begin{column}{columnwidth=0.33\linewidth}
  \subcaptionbox{Subsequence distance matrix\label{sfig:Subsequence distance matrix}}{
    \includegraphics[height=3.0cm, width=3.5cm]{figures/subsequence_distances.pdf}
  }
  \end{column}
  \subcaptionbox{Optimal transport plan\label{sfig:Optimal transport plan}}{%
    \includegraphics[height=3.0cm, width=3.5cm]{figures/optimal_transport.pdf}
  }
  \subcaptionbox{Transport plan visualisation\label{sfig:Intuition transport plan}}
  {%
    \begin{tikzpicture}
      \begin{axis}[%
        axis lines = none,
        height     =  4.5cm,
        width      =  7.0cm,
      ]
        \addplot[Set1-A, thick, no marks] table[x=x, y=a, col sep=comma] {./data/overview_TS_uneq_length_1.csv};
        \addplot[
          Set1-B, thick, no marks,
          y filter/.expression = {
            y - 10
          },
        ] table[x=x, y=a, col sep=comma] {./data/overview_TS_2.csv};

        \draw[draw opacity=0.8, line width=0.6pt] (0.00,0.05) -- (20.00,-10.03);
        \draw[draw opacity=0.8, line width=0.6pt] (5.00,0.08) -- (25.00,-9.75);
        \draw[draw opacity=0.8, line width=0.6pt] (10.00,1.38) -- (30.00,-7.66);
        \draw[draw opacity=0.8, line width=0.6pt] (15.00,3.95) -- (35.00,-6.24);
        \draw[draw opacity=0.8, line width=0.6pt] (20.00,1.87) -- (60.00,-9.92);
        \draw[draw opacity=0.8, line width=0.6pt] (25.00,0.15) -- (0.00,-9.98);
        \draw[draw opacity=0.8, line width=0.15882352941176556pt] (30.00,-0.04) -- (70.00,-10.03);
        \draw[draw opacity=0.8, line width=0.6pt] (35.00,0.01) -- (90.00,-10.01);
        \draw[draw opacity=0.8, line width=0.15882352941176434pt] (40.00,-0.01) -- (65.00,-9.98);
        \draw[draw opacity=0.8, line width=0.6pt] (45.00,-0.00) -- (10.00,-10.01);
        \draw[draw opacity=0.8, line width=0.30588235294117666pt] (50.00,-0.01) -- (75.00,-9.98);
        \draw[draw opacity=0.8, line width=0.45294117647058646pt] (55.00,0.00) -- (85.00,-10.01);
        \draw[draw opacity=0.8, line width=0.6pt] (60.00,-0.00) -- (105.00,-9.99);
        \draw[draw opacity=0.8, line width=0.6pt] (65.00,-0.01) -- (5.00,-10.03);
        \draw[draw opacity=0.8, line width=0.4529411764705877pt] (70.00,0.01) -- (80.00,-9.96);
        \draw[draw opacity=0.8, line width=0.15882352941176434pt] (75.00,0.02) -- (15.00,-9.99);
        \draw[draw opacity=0.8, line width=0.30588235294117666pt] (80.00,0.38) -- (50.00,-9.60);
        \draw[draw opacity=0.8, line width=0.30588235294117666pt] (85.00,1.56) -- (55.00,-8.53);
      \end{axis}
    \end{tikzpicture}
  }
  \end{figure}
  \end{columns} 
\end{frame}

\section{A Wasserstein Kernel for Time Series}
	\input{wtk.tex}

\section{Results}
\input{results.tex}

\section{Take aways}



\begin{frame}[standout]
  Questions?
\end{frame}

\begin{frame}[allowframebreaks]{References}

  \bibliography{ref}
  \bibliographystyle{abbrvnat}

\end{frame}

\appendix

\end{document}

